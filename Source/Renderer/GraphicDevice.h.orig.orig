/*
Author: Anders, Christian
*/
#ifndef GRAPHICDEVICE_H
#define GRAPHICDEVICE_H

#include "stdafx.h"
#include "Shader.h"
<<<<<<< HEAD

namespace Renderer
{
	struct RenderComponent
	{


=======
#include "SimpleText.h"
#include "GLTimer.h"

namespace Renderer
{
	struct GLTimerValue
	{
<<<<<<< HEAD
		string name;
		float ms;
		GLTimerValue(string n, float m)
		{
			name = n;
			ms = m;
		}
	};

	struct RenderComponent
	{
=======
>>>>>>> 264189ecbb29ed92de336788293523449bc35e93
		
>>>>>>> 80eaba5e3fca8b7fc54c82bdf53835239fe42d96
	};

	class DECLSPEC GraphicDevice
	{
	public:
		GraphicDevice();
		~GraphicDevice();

		bool Init();

		void PollEvent(SDL_Event _event);
		void Update(float _dt);
		void Render();

		void ResizeWindow(int _width, int _height);
		void SetTitle(std::string _title);

		void RenderSimpleText(std::string _text, int x, int y);

	private:
		bool InitSDLWindow();
		bool InitGLEW();
		bool InitDeferred();
		bool InitShaders();
		bool InitBuffers();
<<<<<<< HEAD

		void CreateGBufTex(GLenum texUnit, GLenum format, GLuint &texid);
		void CreateDepthTex(GLuint &texid);

		SDL_Window*		m_window;
		SDL_GLContext	m_glContext;

=======
		bool InitTextRenderer();

		void CreateGBufTex(GLenum texUnit, GLenum format, GLuint &texid);
		void CreateDepthTex(GLuint &texid);

<<<<<<< HEAD
=======
		void CreateGBufTex(GLenum texUnit, GLenum format, GLuint &texid);
		void CreateDepthTex(GLuint &texid);

>>>>>>> 264189ecbb29ed92de336788293523449bc35e93
		SDL_Window*		m_window;
		SDL_GLContext	m_glContext;

		// dt and fps
		float m_dt;
		int m_fps;

		// Timer for shader run time
		vector<GLTimerValue> m_glTimerValues;

>>>>>>> 80eaba5e3fca8b7fc54c82bdf53835239fe42d96
		// Window size
		int	m_clientWidth, m_clientHeight;

		// Image buffers
<<<<<<< HEAD
		GLuint m_textImage;
=======
<<<<<<< HEAD
=======
		GLuint m_textImage;
>>>>>>> 264189ecbb29ed92de336788293523449bc35e93
>>>>>>> 80eaba5e3fca8b7fc54c82bdf53835239fe42d96
		GLuint m_outputImage, m_inputImage;
		GLuint m_debuggText;
		GLuint m_depthBuf, m_normTex, m_colorTex;

		// Frame buffer object
		GLuint m_deferredFBO;

		// Shaders
<<<<<<< HEAD
		Shader m_simpleTextShader;
		Shader m_debuggTextShader; // TA BORT DENNA
		Shader m_fullScreenShader;
		Shader m_deferredShader1, m_deferredShader2;
<<<<<<< HEAD
=======

=======
<<<<<<< HEAD
=======
		Shader m_simpleTextShader;
>>>>>>> 264189ecbb29ed92de336788293523449bc35e93
		Shader m_debuggTextShader; // TA BORT DENNA
		Shader m_fullScreenShader;
		Shader m_deferredShader1, m_deferredShader2;

<<<<<<< HEAD
		// SimpleText
		SimpleText m_textRenderer;
=======
>>>>>>> 80eaba5e3fca8b7fc54c82bdf53835239fe42d96
		int simpleText[4608];
		int simpleTextX, simpleTextY;
		GLuint simpleTextBuffer;

		void RenderText();
<<<<<<< HEAD
>>>>>>> simpletext
=======
>>>>>>> 264189ecbb29ed92de336788293523449bc35e93
>>>>>>> 80eaba5e3fca8b7fc54c82bdf53835239fe42d96
	};
}



#endif